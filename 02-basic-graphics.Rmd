

```{r , include=FALSE}
#tutorial::go_interactive(greedy = TRUE)
knitr::opts_chunk$set(echo = TRUE,error=TRUE)
```

# R BASE GRAPHICS - STARTING WITH THE BASICS

## Exploring Base Graphics in R

### Overview of the philosophy behind Râ€™s base graphics system, including its stateful nature 

#### Stateful Nature 
R's base graphics system is stateful, meaning that plots are built up incrementally. You start with an empty plot and add elements to it one by one. This is in contrast to systems like ggplot2, which use a declarative approach where you specify the plot all at once.
Stateful nature means that every new plotting command modifies the existing plot or creates a new one if none exists. This allows for a high degree of flexibility but can sometimes lead to complex and intuitive behavior.

R's base graphics system provides a set of low-level graphics primitives for creating plots. These primitives include functions for drawing points, lines, polygons, text, and more.
By combining these primitives, you can create a wide variety of plots, from simple scatter plots to complex multi-panel layouts.

#### Philosophy 

The philosophy behind R's base graphics system is to provide a flexible and powerful tool for creating a wide range of plots. The emphasis is on simplicity and ease of use, making it easy for users to quickly create informative visualizations.


However, despite that base graphics are powerful, they do have some limitations compared to more modern plotting systems like ggplot2. For instance, they lack some of the advanced features of ggplot2, such as automatic faceting and easy customization of plot themes.

### Introduction to Core Plotting Functions in R 
R provides a variety of core plotting functions that are useful for creating basic visualizations. In this section, we will explore some of the most commonly used plotting functions. The commonly used core plotting functions are __plot()__, __hist()__, __boxplot()__
and __barplot()__.

- The __plot()__ function is used to create scatter plots, line plots, and other types of plots. It is a versatile function that can be used to visualize relationships between two or more variables.
- The __hist()__ function is used to create histograms, which are used to visualize the distribution of a single numeric variable. Note that the optional argument breaks chooses (approximately) how many
bins the histogram should have, and col alters the colour of the bars.
- The __boxplot()__ function is used to create box plots, which are used to visualize the distribution of a numeric variable, optionally broken down by a categorical variable.
- The __barplot()__ function is used to create bar plots, which are used to visualize the distribution of a categorical variable.



## Creating Basic Plots


### Detailed instructions on using plot() for scatter plots and line graphs 


In order to get the full documentation of the  __plot()__ function, run __?plot__ in R. The syntax for the function is given below.

```{r}
# plot(x, y = NULL, type = "p",  xlim = NULL, ylim = NULL,
#     log = "", main = NULL, sub = NULL, xlab = NULL, ylab = NULL,
#     ann = par("ann"), axes = TRUE, frame.plot = axes,
#     panel.first = NULL, panel.last = NULL, asp = NA,
#     xgap.axis = NA, ygap.axis = NA,
#     ...)

```

**Arguments**

- $x, y$:  the $x$ and $y$ arguments provide the __x__ and __y__ coordinates for the plot.
- $type$: 1-character string giving the type of plot desired."p" for points, "l" for lines "b" for both points and lines, "c" for empty points joined by lines, "o" for overplotted points and lines, "s" and "S" for stair steps and "h" for histogram-like vertical lines. Finally, "n" does not produce any points or lines.
- $xlim,\quad ylim$: the __x__ and __y__ limits respectively.
- $log$: a character string which contains "x" if the x axis is to be logarithmic, "y" if the y axis is to be logarithmic and "xy" or "yx" if both axes are to be logarithmic.
- $main$ : a main title for the plot.
- $sub$: a subtitle for the plot.
- $xlab,\quad ylab$ : The labels for x-axis and y-axis respectively, defaults to a description of x and y.

The commonly used graphical parameters are:

- $col$ : The colors for lines and points. Multiple colors can be specified so that each point can be given its own color. If there are fewer colors than points they are recycled in the standard fashion. Lines will all be plotted in the first colour specified.

- $bg$ : a vector of background colors for open plot symbols

- $pch$: a vector of plotting characters or symbols

- $cex$ : a numerical vector giving the amount by which plotting characters and symbols should be scaled relative to the default.

- $lty$: a vector of line types

- $lwd$: a vector of line widths

**Example:**

```{r, height=500}
# Create a scatter plot
x <- c(1, 2, 3, 4, 5)
y <- c(2, 3, 5, 7, 11)
plot(x, y, type = "p", col = "blue", pch = 16, main = "Scatter Plot", xlab = "X", ylab = "Y")

# Create a line plot
plot(x, y, type = "l", col = "red", lwd = 1, main = "Line plot", xlab = NULL, ylab = NULL)

```


### Using hist() to create histograms for data distribution analysis 
Histograms are useful for visualizing the frequency distribution of a single variable. Similarly, you can get more documentation of the __hist()__ function by running the command __?hist__ in R. The generic function __hist__ computes a histogram of the given data values.The default behavior for a histogram is to display frequencies on the vertical axis; probability densities can be displayed using the __freq=FALSE__ option. The default title is given by __paste("Histogram of" , x)__ where __x__ is the name of the variable being plotted; this can be changed with the main option. The common syntax for the function is given below

```{r}
#hist(x, breaks = "Sturges",
#     freq = NULL, probability = !freq,
#     include.lowest = TRUE, right = TRUE, fuzz = 1e-7,
#     density = NULL, angle = 45, col = "lightgray", border = NULL,
#     main = paste("Histogram of" , xname),
#     xlim = range(breaks), ylim = NULL,
#     xlab = xname, ylab,
#     axes = TRUE, plot = TRUE, labels = FALSE,
#     nclass = NULL, warn.unused = TRUE, ...)
```


```{r, height=500}
# Create a histogram
set.seed(100)  # Fix the random numbers generated
data <- rnorm(100)  # Generate some random data
hist(data, breaks = "Sturges", col = "skyblue", main = "Histogram", xlab = "Value", ylab = "Frequency")

```


### Implementing boxplot() and barplot() to visualize data comparisons and distributions 
The __boxplot()__ and __barplot()__ functions in R are commonly used for visualizing data comparisons and distributions.

**1. boxplot()**

The common syntax of the function is given below.
```{r}
#boxplot(x, data = NULL, col = "skyblue", main = NULL, xlab = NULL, ylab = #NULL)

```

**Example**
```{r}
# Create a box plot
data <- data.frame(
  Group = rep(c("A", "B", "C"), each = 50),
  Value = c(rnorm(50), rnorm(50, mean = 2), rnorm(50, mean = 3))
)
boxplot(Value ~ Group, data = data, col = "skyblue", main = "Box Plot", xlab = "Group", ylab = "Value")

```


**2.barplot()**
The syntax used for __barplot()__ function is given below.

```{r}
#barplot(x, names.arg = NULL, col = "skyblue", main = NULL, xlab = NULL, #ylab = NULL)

```


**Example**
```{r}
# Create a bar plot
data <- table(mtcars$cyl)
barplot(data, col = "skyblue", main = "Bar Plot", xlab = "Number of Cylinders", ylab = "Frequency")

```


## Customizing Plots


### Basic customization options including colors, main titles, axis labels, and  plot dimensions 

**1. Changing Colors**
```{r}
# Create a scatter plot with custom colors
x <- c(1, 2, 3, 4, 5)
y <- c(2, 3, 5, 7, 11)
plot(x, y, type = "p", col = "red", pch = 16, main = "", xlab = "X", ylab = "Y")

```

**2. Adding Titles and Axis Labels**
```{r}
# Create a scatter plot with titles and axis labels
x <- c(1, 2, 3, 4, 5)
y <- c(2, 3, 5, 7, 11)
plot(x, y, type = "p", col = "red", pch = 16, main = "Scatter Plot", xlab = "X-axis", ylab = "Y-axis")

```

**3. Changing Plot Dimensions**

```{r}
# Create a scatter plot with custom dimensions
x <- c(1, 2, 3, 4, 5)
y <- c(2, 3, 5, 7, 11)
plot(x, y, type = "p", col = "red", pch = 16, main = "Scatter Plot", xlab = "X", ylab = "Y", xlim = c(0, 6), ylim = c(0, 12))

```

**4. Combining Customization Options**

```{r}
# Create a scatter plot with custom colors, titles, axis labels, and dimensions
x <- c(1, 2, 3, 4, 5)
y <- c(2, 3, 5, 7, 11)
plot(x, y, type = "p", col = "red", pch = 16, main = "Scatter Plot", xlab = "X-axis", ylab = "Y-axis", xlim = c(0, 6), ylim = c(0, 12))

```

You can further customize your plots by adjusting parameters such as __pch__ (for points), __lwd__ (for lines), __lty__ (for line type), __cex__ (for point size), and more.


### Tips on enhancing plot readability and aesthetic appeal 
In order to have a plot with enhanced readability and have an aesthetic appeal, you need to use some of these tips:

- **Choose appropriate colors:** Use colors that complement each other and make it easy to distinguish different elements of the plot.Avoid using colors that are too bright or too similar to each other.
- **Use appropriate font sizes and styles:** Use larger font sizes for titles and axis labels to make them more prominent.
- **Add grid lines:** Adding grid lines can make it easier to read the plot and interpret the data.
- **Use appropriate plot types:** Choose the appropriate plot type for your data. For example, use a scatter plot for continuous data and a bar plot for categorical data.
- **Use consistent and intuitive labeling:** Make sure that the labels on your plot are consistent and intuitive, making it easy for readers to understand the information presented.
- **Use legends for clarity:** Use legends to explain the meaning of different colors or symbols used in the plot.


You can also add more improvements to your plot to make it look more nice and appealing.


## Practical Examples: Exercises

**Exercise 6**

Create a dataframe of marks of 1000 students (male and female) with their respective status i.e pass if marks >= 40, fail otherwise (set a seed to 100). Additionally,  let the student marks  be graded using factor method in the following format:

A: 70 marks and above

B: 60-69

C: 50-59

D: 40-49

E: Below 40 marks

Create a dataframe called students with the vectors; id, gender, marks, grade and status where status is a column which shows whether the student passed or failed.You will use this dataframe to answer exercise 7,8 and 9.Note: The minimum mark should be 10 marks

```{r, ex="exercise_num2.1", type="sample-code", height=500}
# Your code
```
```{r, ex="exercise_num2.1", type="solution"}
#Solution

id<-1:1000
set.seed(100)
marks<-sample(c(10:100),1000, replace = TRUE)
gender<-sample(c("Male","Female"),1000,replace = TRUE)
grade<-factor(c(marks >=0)+ (marks >=40) + (marks >=50) + (marks >=60) +(marks >=70), labels=c("E","D","C","B","A"))
status<-factor(c(marks >=0)+ (marks >=40), labels=c("Fail","Pass"))
students<-data.frame(id, gender,marks, grade, status)

```



**Exercise 7**

Plot a box plot to show the distribution of marks by gender.Give it a title, 'Distribution of Student Marks'. The x-axis should be labelled as 'Gender' while the y-axis should be labelled as 'Marks'. Apply blue color to male and green color to female. Set cex.main and cex.lab to 1.2.  

```{r,  ex="exercise_num2.2", type="sample-code", height=500}
#Your code
```
```{r, ex="exercise_num2.2", type="solution", height=500}
# Solution

id<-1:1000
set.seed(100)
marks<-sample(c(10:100),1000, replace = TRUE)
gender<-sample(c("Male","Female"),1000,replace = TRUE)
grade<-factor(c(marks >=0)+ (marks >=40) + (marks >=50) + (marks >=60) +(marks >=70), labels=c("E","D","C","B","A"))
status<-factor(c(marks >=0)+ (marks >=40), labels=c("Fail","Pass"))
students<-data.frame(id, gender,marks, grade, status)
# Customized box plot with different colors, labels, and larger font sizes
boxplot(marks ~ gender, data = students, col = c("green", "blue"), main = "Distribution of Student Marks", xlab = "Gender", ylab = "Marks", cex.main = 1.2, cex.lab = 1.2)

```


**Exercise 8**

Plot a histogram of the marks where the bins should be equivalent to the classes of grading. Which grade had the highest number of students? How were the marks distributed in the class? Fill the histogram with red. Add a customized title and label the axes. 

```{r, ex="exercise_num2.3", type="sample-code", height=500}
#Your code
```
```{r, ex="exercise_num2.3", type="solution", height=500}
# Solution
# Create the students dataframe
id <- 1:1000
set.seed(60)
marks <- sample(10:100, 1000, replace = TRUE)
gender <- sample(c("Male", "Female"), 1000, replace = TRUE)
grade <- factor(c(marks >= 0) + (marks >= 40) + (marks >= 50) + (marks >= 60) + (marks >= 70), labels = c("E", "D", "C", "B", "A"))
status <- factor(c(marks >= 0) + (marks >= 40), labels = c("Fail", "Pass"))
students <- data.frame(id, gender, marks, grade, status)

# Define breaks based on the grading classes
breaks <- c(0, 40, 50, 60, 70, 100)

# Create the histogram
hist(students$marks, breaks = breaks, col = "red", 
     main = "Distribution of Marks by Grade", 
     xlab = "Marks", ylab = "Number of Students")
# Count the number of students in each grade
grade_counts <- table(students$grade)
print(grade_counts)

# Determine the grade with the highest number of students
highest_grade <- names(which.max(grade_counts))
cat("The grade with the highest number of students is:", highest_grade, "\n")

```



**Exercise 9**

Use a well customized barpot to show the mean mark of students by gender. Which gender had the highest average score?

```{r, ex="exercise_num2.4", type="sample-code", height=500}
#Your code
```
```{r, ex="exercise_num2.4", type="solution", height=500}
# Solution
# Create the students dataframe
id <- 1:1000
set.seed(100)
marks <- sample(10:100, 1000, replace = TRUE)
gender <- sample(c("Male", "Female"), 1000, replace = TRUE)
grade <- factor(c(marks >= 0) + (marks >= 40) + (marks >= 50) + (marks >= 60) + (marks >= 70), labels = c("E", "D", "C", "B", "A"))
status <- factor(c(marks >= 0) + (marks >= 40), labels = c("Fail", "Pass"))
students <- data.frame(id, gender, marks, grade, status)
# Calculate the mean marks by gender
mean_marks_by_gender <- aggregate(marks ~ gender, data = students, mean)

# Plot the barplot
barplot(mean_marks_by_gender$marks, 
        names.arg = mean_marks_by_gender$gender,
        col = c("blue", "pink"),
        main = "Mean Marks by Gender",
        xlab = "Gender",
        ylab = "Mean Marks",
        ylim = c(0, 100),
        beside = TRUE,
        border = "black",
        las = 1, # make axis labels perpendicular to axis
        cex.names = 1.2, # adjust the size of the axis labels
        cex.axis = 1.2, # adjust the size of the axis text
        cex.main = 1.5, # adjust the size of the main title
        cex.lab = 1.2) # adjust the size of the axis labels text

# Add text labels on top of the bars
text(x = c(1, 2), 
     y = mean_marks_by_gender$marks, 
     label = round(mean_marks_by_gender$marks, 1), 
     pos = 3, # position above the bars
     cex = 1.2, # adjust the size of the text
     col = "black")

# Determine which gender had the highest average score
highest_avg_gender <- mean_marks_by_gender[which.max(mean_marks_by_gender$marks), ]
cat("The gender with the highest average score is:", highest_avg_gender$gender, "with an average score of", round(highest_avg_gender$marks, 1), "marks", "\n")

```


